# Project Context

## Purpose

A public GitHub template repository that implements a factory pattern for managing GitHub organization
repositories using Terraform. Users can fork this template to manage their own GitHub organization's
repository configurations as code.

**Goals:**

- Enable GitOps workflows for GitHub repository management
- Provide consistent security policies across repositories
- Reduce manual configuration overhead
- Support both personal accounts and organizations

## Tech Stack

- **Terraform** >= 1.0 - Infrastructure as Code
- **GitHub Provider** ~> 6.0 - Terraform provider for GitHub
- **YAML** - Configuration format (parsed via Terraform's `yamldecode()`)
- **Python** 3.x - Validation scripts
- **GitHub Actions** - CI/CD automation

## Project Conventions

### Code Style

**Terraform:**

- Use `terraform fmt` for formatting
- Use descriptive variable names
- Document all variables with descriptions
- Use locals for computed values
- Keep modules focused and small

**YAML:**

- 2-space indentation
- Use descriptive keys
- Comment complex configurations

### Architecture Patterns

**Factory Pattern:**

- Configuration files define "what" (repositories, settings)
- Terraform modules define "how" (resource creation)
- YAML parsing layer transforms configuration to module inputs

**Configuration Inheritance:**

- Base settings in `config.yml`
- Shared settings in configuration groups
- Repository-specific overrides
- Merge strategy: later values override, lists merge

### Testing Strategy

- `terraform validate` for syntax checking
- `terraform plan` for dry-run verification
- Python scripts for YAML schema validation
- Pre-commit hooks for consistency

### Git Workflow

- Main branch protected with required reviews
- Feature branches for changes
- PR-based workflow with Terraform plan in CI
- Apply only after approval

## Domain Context

**GitHub Concepts:**

- Repository: A git repository with associated settings
- Team: A group of users with shared permissions
- Collaborator: An individual user with repository access
- Ruleset: A set of rules enforcing policies on branches/tags
- Visibility: public, private, or internal (enterprise only)

**Subscription Tiers:**

- Free: Limited ruleset support (public repos only)
- Pro: Rulesets for all repos (personal accounts)
- Team/Enterprise: Full feature set including push rulesets

## Important Constraints

- Must work with GitHub Free tier (gracefully degrade)
- State files contain repository metadata (use remote backend in production)
- GitHub API rate limits apply (~5000 requests/hour)
- Cannot manage GitHub Actions workflows within repositories
- Team slugs must exist before being referenced

## External Dependencies

- **GitHub API** - All operations go through GitHub's REST/GraphQL API
- **Terraform Registry** - Provider downloads
- **Remote State Backend** (optional) - S3, GCS, Terraform Cloud for team collaboration
